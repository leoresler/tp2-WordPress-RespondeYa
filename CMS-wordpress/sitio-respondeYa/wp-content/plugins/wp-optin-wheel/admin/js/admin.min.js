jQuery(document).ready(function(){new Core.Admin.Main(jQuery(document.body))});
var Core;!function(t){!function(e){var i=function(){function i(e){var n=t.Admin.Helpers.Context.getSlug();this.slug=n,this.parent=e,this.navlinks=this.parent.find(".mabel-nav-tab-wrapper a"),this.tabs=this.parent.find(".mabel-tab"),this.form=this.parent.find("#"+n+"-form"),this.settingsKey=t.Admin.Helpers.Context.getSettingsKey(),this.currentTab=this.parent.find(".mabel-nav-tab-active").data("tab"),this.sidebars=this.parent.find(".mabel-sidebar"),this.mainSidebar=this.sidebars.filter('[data-sidebar-for="main"]'),this.initColorPickers(),this.initDatePickers(),this.initRangeSliders(),this.initTabs(),this.initAccordions(),t.Admin.Helpers.Dependencies.initDependencies(this.settingsKey),this.toggleSidebars(),this.initChangeSettings(),this.initEvents(),i.initChoicePickers()}return i.loading=function(){this.isLoading?jQuery(".mabel-loading").hide():jQuery(".mabel-loading").show(),this.isLoading=!this.isLoading},i.prototype.initDatePickers=function(){function t(t){if(t.indexOf("AM")>-1||t.indexOf("PM")>-1){var e=jQuery.trim(t).split(" ");return e[e.length-2]+" "+e[e.length-1]}var i=new Date,n=i.getHours(),a=i.getMinutes(),s="A'M'";return a<10&&(a="0"+a),12==n?s=" 'PM'":0==n?(n=12,s=" A'M'"):n>12?(n-=12,s=" P'M'"):s=" A'M'"," "+n+":"+a+s}jQuery(".mabel-date-picker").each(function(e,i){var n=jQuery(i),a=n.data("options")||{};n.datepicker(jQuery.extend(a,{dateFormat:"M dd, yy"+t(n.val()),onSelect:function(t){i.dispatchEvent(new Event("input"))}}))})},i.initChoicePickers=function(){jQuery(".mabel-mc-wrapper").each(function(e,i){new t.Admin.Components.ChoicePicker(jQuery(i))})},i.prototype.initRangeSliders=function(){jQuery('input[type="range"]').each(function(t,e){var i=jQuery(e);i.rangeslider({polyfill:!1,onSlideEnd:function(t,e){i.val(e)}})})},i.prototype.initAccordions=function(){this.parent.find(".mabel-accordion button.mabel-accordion-btn").on("click",function(t){t.preventDefault();var e=jQuery(this);e.next().stop(!0,!1).slideToggle(125),e.toggleClass("active")})},i.prototype.initEvents=function(){var e=this,i=window.tb_remove;window.tb_remove=function(){i(),t.Admin.Dispatcher.publish("modal:closed"),e.saveSettings()},t.Admin.Dispatcher.subscribe("settings:save",function(){e.saveSettings()})},i.prototype.initColorPickers=function(){var e=this;this.parent.find(".color-picker").each(function(i,n){function a(i,n){var a=jQuery(i.target),s=a.attr("name");t.Admin.Dispatcher.publish("color:changed",{color:n.color.toString(),id:s}),a.parents(".skip-save").length||(e.saveSettings(),t.Admin.Dispatcher.publish("settings:changed",t.Admin.Helpers.Context.getSettings()))}var s=jQuery(n);if(s.wpColorPicker({defaultColor:s.val(),change:function(t,e){a(t,e)},clear:function(){a({target:s[0]},{color:""})}}),s.val().length){var r={target:n},o={color:s.val()};setTimeout(function(){a(r,o)},30)}})},i.prototype.initChangeSettings=function(){var i=this;this.form.find(".mabel-form-element").on("change",function(n){var a=jQuery(n.currentTarget);a.hasClass("skip-save")||a.parents(".skip-save").length||(e.Dispatcher.publish("settings:changed",t.Admin.Helpers.Context.getSettings()),i.saveSettings())}),this.form.find('input[type="number"]').not(".skip-save").each(function(t,e){var n=jQuery(e);if(!n.parents(".skip-save").length){var a=0;n.on("change keyup keydown input",function(){clearTimeout(a),a=setTimeout(function(){i.saveSettings()},600)})}})},i.prototype.saveSettings=function(){var e=this;if(window.canSaveData){this.parent.find(".all-settings-saved").hide(),this.parent.find(".saving-settings").show();var i=this.form.serialize();jQuery.post("options.php",i).done(function(){e.parent.find(".all-settings-saved").show(),e.parent.find(".saving-settings").hide(),t.Admin.Dispatcher.publish("settings:saved",t.Admin.Helpers.Context.getSettings())})}},i.prototype.initDependencies=function(){var t=this;this.parent.find("[data-dependency]").each(function(e,i){var n=jQuery(i);n.data("dependency").forEach(function(e){var i=t.parent.find('[name="'+t.settingsKey+"["+e.element_id+']"],[name="'+e.element_id+'"]').not(".skip-dependency");i.length&&(i.on("change",function(){var t=i.val(),a=!1;if(i.is(":checkbox")){var s=i.is(":checked");t==e.value&&s&&(a=!0)}else t==e.value&&(a=!0);a?n.closest("tr").show():n.closest("tr").hide()}),i.trigger("change"))})})},i.prototype.initTabs=function(){var e=this,i=this.parent.find(".mabel-nav-tab-wrapper a");this.parent.find(".mabel-tab");i.on("click",function(t){t.preventDefault(),e.setTab(jQuery(t.currentTarget).data("tab"))}),t.Admin.Dispatcher.subscribe("tab:activate",function(t){e.setTab(t)})},i.prototype.setTab=function(e){var i=this.parent.find('[data-tab="'+e+'"]');this.navlinks.removeClass("mabel-nav-tab-active"),i.addClass("mabel-nav-tab-active"),this.tabs.hide(),this.parent.find(".tab-"+e).show(),t.Admin.Dispatcher.publish("tab:changed",e),this.currentTab=e,this.toggleSidebars()},i.prototype.toggleSidebars=function(){this.sidebars.hide();var t=this.sidebars.filter('[data-sidebar-for="'+this.currentTab+'"]');t.length&&!t.is(":empty")?t.show():this.mainSidebar.show()},i}();e.Main=i}(t.Admin||(t.Admin={}))}(Core||(Core={}));
var Core;!function(i){!function(i){var t=function(){function i(){}return i.subscribe=function(i,t){this.hOP.call(this.topics,i)||(this.topics[i]=[]);var o=this.topics[i].push(t)-1;return{remove:function(){delete this.topics[i][o]}}},i.publish=function(i,t){this.hOP.call(this.topics,i)&&this.topics[i].forEach(function(i){i(void 0!=t?t:{})})},i.topics=[],i.hOP=[].hasOwnProperty,i}();i.Dispatcher=t}(i.Admin||(i.Admin={}))}(Core||(Core={}));
var Core;!function(t){!function(t){!function(t){var e=function(){function t(t){this.wrapper=t,this.input=t.find("input[type=hidden]"),this.infotext=t.find(".mabel-mc-chosen em"),this.init()}return t.prototype.init=function(){this.values=this.input.val().split(";"),this.setSelectedValues(),this.initAddToValues(),this.initRemoveFromValues()},t.prototype.setSelectedValues=function(){var t=this;this.wrapper.find(".mabel-mc-choice").remove(),this.wrapper.find(".mabel-mc-option").each(function(e,i){var n=jQuery(i);jQuery.inArray(n.data("id").toString(),t.values)>-1&&(n.css("opacity",.6),t.createChosenOption(n.data("id"),n.html()),t.infotext.hide())})},t.prototype.initAddToValues=function(){var t=this;this.wrapper.find(".mabel-mc-option").off("click").on("click",function(e){e.preventDefault();var i=jQuery(e.currentTarget),n=i.data("id").toString();if(!(jQuery.inArray(n,t.values)>-1)){var a=i.html();t.values.push(n),t.input.val(t.values.join(";")),t.infotext.hide(),i.css("opacity",.6),t.createChosenOption(n,a),t.input[0].dispatchEvent(new Event("input"))}})},t.prototype.initRemoveFromValues=function(){var t=this;this.wrapper.off("click",".mabel-mc-choice"),this.wrapper.on("click",".mabel-mc-choice",function(e){e.preventDefault();var i=jQuery(e.currentTarget),n=i.data("id").toString();t.wrapper.find(".mabel-mc-option[data-id="+n+"]").css("opacity",1),i.remove(),t.values.splice(t.values.indexOf(n),1),t.values.length||t.infotext.show(),t.input.val(t.values.join(";")),t.input[0].dispatchEvent(new Event("input"))})},t.prototype.createChosenOption=function(t,e){this.wrapper.find(".mabel-mc-chosen").append('<span class="mabel-mc-choice" data-id="'+t+'">'+e+' <span class="mabel-mc-close">&times;</span></span>')},t}();t.ChoicePicker=e}(t.Components||(t.Components={}))}(t.Admin||(t.Admin={}))}(Core||(Core={}));
var Core;!function(e){!function(e){!function(e){var t=function(){function e(e,t){var i=this;this.onSelect=t,this.initMediaSelector(),e.on("click",function(e){e.preventDefault(),i.mediaSelector.open()})}return e.prototype.initMediaSelector=function(){var e=this;this.mediaSelector=window.wp.media.frames.file_frame=window.wp.media({multiple:!1,title:"Choose or upload an image",button:{text:"Use this image"}}),this.mediaSelector.on("select",function(){var t=e.mediaSelector.state().get("selection").first().toJSON();e.onSelect(t)})},e}();e.MediaSelector=t}(e.Components||(e.Components={}))}(e.Admin||(e.Admin={}))}(Core||(Core={}));
var Core;!function(e){!function(e){!function(t){var n=function(){function t(t,n){void 0===n&&(n=null);var l=this;this.$input=t.find("input[type=text]"),this.$parent=t,this.$hidden=t.find("input[type=hidden]"),this.values=t.data("values")?t.data("values"):[],this.onChange=n,this.$input.on("keydown",function(){l.$input.css("width",50+8*l.$input.val().length)}),t.on("click",function(e){e.preventDefault(),l.$input.focus()}),t.mabelAutocomplete(e.Helpers.Context.getAdminAjaxUrl()+"?action="+t.data("action"),{multiple:!0,multipleSep:";",delay:350,onSelect:function(e){l.values.push(e),l.$input.val(""),l.setHiddenValue(),l.addElementsToUi(e),"function"==typeof n&&n(l.$hidden.val())}})}return t.prototype.setValues=function(e){var t=this;this.values=e,this.setHiddenValue(),this.values.forEach(function(e){t.addElementsToUi(e)})},t.prototype.clear=function(){this.values=[],this.$hidden.val(""),this.$parent.find(".mabel-autoselect-chosen").remove()},t.prototype.addElementsToUi=function(e){var t=this;jQuery('<span class="mabel-autoselect-chosen"></span>').html(e.title).on("click",function(n){n.preventDefault(),jQuery(n.currentTarget).remove(),t.values.forEach(function(n,l){n.title===e.title&&t.values.splice(l,1)}),t.setHiddenValue(),"function"==typeof t.onChange&&t.onChange(t.$hidden.val())}).insertBefore(this.$input)},t.prototype.setHiddenValue=function(){var e=[];this.values.forEach(function(t){e.push(t.id)}),this.$hidden.val(e.join(","))},t}();t.MultiAutoComplete=n}(e.Components||(e.Components={}))}(e.Admin||(e.Admin={}))}(Core||(Core={})),function(e){e.mabelautocomplete=function(t,n){function l(){var e=m.offset();v.css({top:e.top+m.outerHeight()+"px",left:e.left+"px"})}function i(e){if(/27$|38$|40$/.test(e.keyCode)&&v.is(":visible")||/^13$|^9$/.test(e.keyCode)&&r())switch(e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0,e.returnValue=!1,e.keyCode){case 38:h();break;case 40:p();break;case 9:case 13:d();break;case 27:v.hide()}else m.val().length!=g&&(C&&clearTimeout(C),C=setTimeout(s,n.delay),g=m.val().length)}function s(){var t,l,i=e.trim(m.val());if(n.multiple&&-1!=(t=i.lastIndexOf(n.multipleSep))&&(i=e.trim(i.substr(t+n.multipleSep.length))),i.length>=n.minchars){var s=a(i);s?u(s.items):(f.addClass("mabel-autocomplete-loading"),e.getJSON(n.source,{q:i},function(e){v.hide(),l=[];for(var t=0;t<e.length;t++)l.push(c(e[t],i));u(l),o(i,l),f.removeClass("mabel-autocomplete-loading")}))}else v.hide()}function a(e){var t;for(t=0;t<y.length;t++)if(y[t].q==e)return y.unshift(y.splice(t,1)[0]),y[0];return!1}function o(e,t){y.push({q:e,items:t})}function u(t){var i,s="";if(t){if(!t.length)return void v.hide();for(l(),i=0;i<t.length;i++)s+="<li>"+t[i]+"</li>";v.html(s).show(),v.children("li").mouseover(function(){v.children("li").removeClass(n.selectClass),e(this).addClass(n.selectClass)}).click(function(e){e.preventDefault(),e.stopPropagation(),d()})}}function c(t,l){return e.trim(t.title).replace(new RegExp(l,"ig"),function(e){return'<span data-id="'+t.id+'" class="'+n.matchClass+'">'+e+"</span>"})}function r(){var e;return!!v.is(":visible")&&(e=v.children("li."+n.selectClass),e.length||(e=!1),e)}function d(){var e=r();if(e){var t=e.text(),l=e.find("span").first().data("id");n.onSelect&&n.onSelect({title:t,id:l})}}function p(){var e=r();e?e.removeClass(n.selectClass).next().addClass(n.selectClass):v.children("li:first-child").addClass(n.selectClass)}function h(){var e=r();e?e.removeClass(n.selectClass).prev().addClass(n.selectClass):v.children("li:last-child").addClass(n.selectClass)}var f,m,v,C,g,y;f=e(t),m=f.find("input[type=text]").attr("autocomplete","off"),v=e('<ul class="mabel-autocomplete-results"/>'),C=!1,g=0,y=[],v.addClass(n.resultsClass).appendTo("body"),l(),e(window).on("load",l).on("resize",l),m.blur(function(){setTimeout(function(){v.hide()},200)}),m.keydown(i)},e.fn.mabelAutocomplete=function(t,n){if(t)return n=n||{},n.multiple=n.multiple||!1,n.multipleSep=n.multipleSep||",",n.source=t,n.delay=n.delay||100,n.resultsClass=n.resultsClass||"ac_results",n.selectClass=n.selectClass||"ac_over",n.matchClass=n.matchClass||"ac_match",n.minchars=n.minchars||2,n.delimiter=n.delimiter||"\n",n.onSelect=n.onSelect||!1,n.maxCacheSize=n.maxCacheSize||65536,this.each(function(){new e.mabelautocomplete(this,n)}),this}}(jQuery);
!function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t(require("jquery")):t(jQuery)}(function(t){"use strict";function i(t,i){var e=Array.prototype.slice.call(arguments,2);return setTimeout(function(){return t.apply(null,e)},i)}function e(t,i){return i=i||100,function(){if(!t.debouncing){var e=Array.prototype.slice.apply(arguments);t.lastReturnVal=t.apply(window,e),t.debouncing=!0}return clearTimeout(t.debounceTimeout),t.debounceTimeout=setTimeout(function(){t.debouncing=!1},i),t.lastReturnVal}}function n(t){return t&&(0===t.offsetWidth||0===t.offsetHeight||!1===t.open)}function s(t){for(var i=[],e=t.parentNode;n(e);)i.push(e),e=e.parentNode;return i}function o(t,i){function e(t){void 0!==t.open&&(t.open=!t.open)}var n=s(t),o=n.length,r=[],h=t[i];if(o){for(var a=0;a<o;a++)r[a]=n[a].style.cssText,n[a].style.setProperty?n[a].style.setProperty("display","block","important"):n[a].style.cssText+=";display: block !important",n[a].style.height="0",n[a].style.overflow="hidden",n[a].style.visibility="hidden",e(n[a]);h=t[i];for(var l=0;l<o;l++)n[l].style.cssText=r[l],e(n[l])}return h}function r(t,i){var e=parseFloat(t);return Number.isNaN(e)?i:e}function h(t){return t.charAt(0).toUpperCase()+t.substr(1)}function a(n,s){if(this.$window=t(window),this.$document=t(document),this.$element=t(n),this.options=t.extend({},p,s),this.polyfill=this.options.polyfill,this.orientation=this.$element[0].getAttribute("data-orientation")||this.options.orientation,this.onInit=this.options.onInit,this.onSlide=this.options.onSlide,this.onSlideEnd=this.options.onSlideEnd,this.DIMENSION=f.orientation[this.orientation].dimension,this.DIRECTION=f.orientation[this.orientation].direction,this.DIRECTION_STYLE=f.orientation[this.orientation].directionStyle,this.COORDINATE=f.orientation[this.orientation].coordinate,this.polyfill&&u)return!1;this.identifier="js-"+l+"-"+d++,this.startEvent=this.options.startEvent.join("."+this.identifier+" ")+"."+this.identifier,this.moveEvent=this.options.moveEvent.join("."+this.identifier+" ")+"."+this.identifier,this.endEvent=this.options.endEvent.join("."+this.identifier+" ")+"."+this.identifier,this.toFixed=(this.step+"").replace(".","").length-1,this.$fill=t('<div class="'+this.options.fillClass+'" />'),this.$handle=t('<div class="'+this.options.handleClass+'" />'),this.$range=t('<div class="'+this.options.rangeClass+" "+this.options[this.orientation+"Class"]+'" id="'+this.identifier+'" />').insertAfter(this.$element).prepend(this.$fill,this.$handle),this.$element.css({position:"absolute",width:"1px",height:"1px",overflow:"hidden",opacity:"0"}),this.handleDown=t.proxy(this.handleDown,this),this.handleMove=t.proxy(this.handleMove,this),this.handleEnd=t.proxy(this.handleEnd,this),this.init();var o=this;this.$window.on("resize."+this.identifier,e(function(){i(function(){o.update(!1,!1)},300)},20)),this.$document.on(this.startEvent,"#"+this.identifier+":not(."+this.options.disabledClass+")",this.handleDown),this.$element.on("change."+this.identifier,function(t,i){if(!i||i.origin!==o.identifier){var e=t.target.value,n=o.getPositionFromValue(e);o.setPosition(n)}})}Number.isNaN=Number.isNaN||function(t){return"number"==typeof t&&t!==t};var l="rangeslider",d=0,u=function(){var t=document.createElement("input");return t.setAttribute("type","range"),"text"!==t.type}(),p={polyfill:!0,orientation:"horizontal",rangeClass:"rangeslider",disabledClass:"rangeslider--disabled",activeClass:"rangeslider--active",horizontalClass:"rangeslider--horizontal",verticalClass:"rangeslider--vertical",fillClass:"rangeslider__fill",handleClass:"rangeslider__handle",startEvent:["mousedown","touchstart","pointerdown"],moveEvent:["mousemove","touchmove","pointermove"],endEvent:["mouseup","touchend","pointerup"]},f={orientation:{horizontal:{dimension:"width",direction:"left",directionStyle:"left",coordinate:"x"},vertical:{dimension:"height",direction:"top",directionStyle:"bottom",coordinate:"y"}}};a.prototype.init=function(){this.update(!0,!1),this.onInit&&"function"==typeof this.onInit&&this.onInit()},a.prototype.update=function(t,i){t=t||!1,t&&(this.min=r(this.$element[0].getAttribute("min"),0),this.max=r(this.$element[0].getAttribute("max"),100),this.value=r(this.$element[0].value,Math.round(this.min+(this.max-this.min)/2)),this.step=r(this.$element[0].getAttribute("step"),1)),this.handleDimension=o(this.$handle[0],"offset"+h(this.DIMENSION)),this.rangeDimension=o(this.$range[0],"offset"+h(this.DIMENSION)),this.maxHandlePos=this.rangeDimension-this.handleDimension,this.grabPos=this.handleDimension/2,this.position=this.getPositionFromValue(this.value),this.$element[0].disabled?this.$range.addClass(this.options.disabledClass):this.$range.removeClass(this.options.disabledClass),this.setPosition(this.position,i)},a.prototype.handleDown=function(t){if(t.preventDefault(),this.$document.on(this.moveEvent,this.handleMove),this.$document.on(this.endEvent,this.handleEnd),this.$range.addClass(this.options.activeClass),!((" "+t.target.className+" ").replace(/[\n\t]/g," ").indexOf(this.options.handleClass)>-1)){var i=this.getRelativePosition(t),e=this.$range[0].getBoundingClientRect()[this.DIRECTION],n=this.getPositionFromNode(this.$handle[0])-e,s="vertical"===this.orientation?this.maxHandlePos-(i-this.grabPos):i-this.grabPos;this.setPosition(s),i>=n&&i<n+this.handleDimension&&(this.grabPos=i-n)}},a.prototype.handleMove=function(t){t.preventDefault();var i=this.getRelativePosition(t),e="vertical"===this.orientation?this.maxHandlePos-(i-this.grabPos):i-this.grabPos;this.setPosition(e)},a.prototype.handleEnd=function(t){t.preventDefault(),this.$document.off(this.moveEvent,this.handleMove),this.$document.off(this.endEvent,this.handleEnd),this.$range.removeClass(this.options.activeClass),this.$element.trigger("change",{origin:this.identifier}),this.onSlideEnd&&"function"==typeof this.onSlideEnd&&this.onSlideEnd(this.position,this.value)},a.prototype.cap=function(t,i,e){return t<i?i:t>e?e:t},a.prototype.setPosition=function(t,i){var e,n;void 0===i&&(i=!0),e=this.getValueFromPosition(this.cap(t,0,this.maxHandlePos)),n=this.getPositionFromValue(e),this.$fill[0].style[this.DIMENSION]=n+this.grabPos+"px",this.$handle[0].style[this.DIRECTION_STYLE]=n+"px",this.setValue(e),this.position=n,this.value=e,i&&this.onSlide&&"function"==typeof this.onSlide&&this.onSlide(n,e)},a.prototype.getPositionFromNode=function(t){for(var i=0;null!==t;)i+=t.offsetLeft,t=t.offsetParent;return i},a.prototype.getRelativePosition=function(t){var i=h(this.COORDINATE),e=this.$range[0].getBoundingClientRect()[this.DIRECTION],n=0;return void 0!==t.originalEvent["client"+i]?n=t.originalEvent["client"+i]:t.originalEvent.touches&&t.originalEvent.touches[0]&&void 0!==t.originalEvent.touches[0]["client"+i]?n=t.originalEvent.touches[0]["client"+i]:t.currentPoint&&void 0!==t.currentPoint[this.COORDINATE]&&(n=t.currentPoint[this.COORDINATE]),n-e},a.prototype.getPositionFromValue=function(t){var i;return i=(t-this.min)/(this.max-this.min),Number.isNaN(i)?0:i*this.maxHandlePos},a.prototype.getValueFromPosition=function(t){var i,e;return i=t/(this.maxHandlePos||1),e=this.step*Math.round(i*(this.max-this.min)/this.step)+this.min,Number(e.toFixed(this.toFixed))},a.prototype.setValue=function(t){t===this.value&&""!==this.$element[0].value||this.$element.val(t).trigger("input",{origin:this.identifier})},a.prototype.destroy=function(){this.$document.off("."+this.identifier),this.$window.off("."+this.identifier),this.$element.off("."+this.identifier).removeAttr("style").removeData("plugin_"+l),this.$range&&this.$range.length&&this.$range[0].parentNode.removeChild(this.$range[0])},t.fn[l]=function(i){var e=Array.prototype.slice.call(arguments,1);return this.each(function(){var n=t(this),s=n.data("plugin_"+l);s||n.data("plugin_"+l,s=new a(this,i)),"string"==typeof i&&s[i].apply(s,e)})}});
var Core;!function(t){!function(t){!function(t){var e=function(){function t(t){var e=this;this.stepContents=t.find("[data-step]"),this.steps=t.find(".step"),this.currentStep=1,t.find(".mabel-btn-next-step").off("click").on("click",function(t){t.preventDefault(),e.next()}),t.find(".mabel-btn-prev-step").off("click").on("click",function(t){t.preventDefault(),e.prev()}),this.steps.on("click",function(t){var s=jQuery(t.currentTarget);(s.hasClass("done")||s.hasClass("current"))&&e.setStep(e.steps.index(s)+1)})}return t.prototype.toggleClasses=function(){this.stepContents.hide(),this.stepContents.eq(this.currentStep-1).show(),this.steps.filter(".current").addClass("done").removeClass("current"),this.steps.eq(this.currentStep-1).addClass("current"),jQuery("html,body").scrollTop(0)},t.prototype.jumpToLastStep=function(){this.currentStep=this.steps.length,this.toggleClasses(),this.steps.addClass("done")},t.prototype.reset=function(){this.steps.removeClass("done"),this.currentStep=1,this.toggleClasses()},t.prototype.setStep=function(t){this.currentStep=t,this.toggleClasses()},t.prototype.next=function(){this.currentStep++,this.toggleClasses()},t.prototype.prev=function(){this.currentStep--,this.toggleClasses()},t}();t.StepTracker=e}(t.Components||(t.Components={}))}(t.Admin||(t.Admin={}))}(Core||(Core={}));
var Core;!function(t){!function(t){!function(t){var e=function(){function t(){}return t.getSlug=function(){return jQuery("[data-context]").data("slug")},t.getSettings=function(){var e=jQuery("#"+t.getSlug()+"-form").serializeArray(),n={};return e.forEach(function(e,r){var a=e.name.replace(t.getSettingsKey()+"[","").replace("]","");n[a]=e.value}),n},t.getSettingsKey=function(){return jQuery("[data-context]").data("settings-key")},t.getAdminAjaxUrl=function(){return jQuery("[data-context]").data("admin-ajax-url")},t}();t.Context=e}(t.Helpers||(t.Helpers={}))}(t.Admin||(t.Admin={}))}(Core||(Core={}));
var Core;!function(e){!function(e){!function(e){var n=function(){function e(){}return e.initDependencies=function(e){var n=this;jQuery("[data-dependency]").each(function(e,i){jQuery(i).data("dependency").forEach(function(e){var t=n.findDependencyById(e.element_id);null===t?n.dependencies.push({id:e.element_id,values:[{show_element:jQuery(i).attr("name"),value:e.value}]}):t.values.push({value:e.value,show_element:jQuery(i).attr("name")})})}),this.dependencies.forEach(function(i){var t=jQuery('[name="'+e+"["+i.id+']"],[name="'+i.id+'"]').not(".skip-dependency");t.on("change",function(c){var d=t.val();t.is(":checkbox")&&(d=t.is(":checked")),t.is(":radio")&&(d=t.filter(":checked").val()),n.hideAllElementsInDependency(e,i),n.findElementsWithValue(i.values,d).forEach(function(e){jQuery('[name="'+e+'"]').closest("tr").show()})}),t.trigger("change")})},e.findElementsWithValue=function(e,n){var i=[];return e.forEach(function(e){e.value==n.toString()&&i.push(e.show_element)}),i},e.hideAllElementsInDependency=function(e,n){n.values.forEach(function(e){jQuery('[name="'+e.show_element+'"]').closest("tr").hide()})},e.findDependencyById=function(e){for(var n=0;n<this.dependencies.length;n++){var i=this.dependencies[n];if(i.id===e)return i}return null},e.dependencies=[],e}();e.Dependencies=n}(e.Helpers||(e.Helpers={}))}(e.Admin||(e.Admin={}))}(Core||(Core={}));
var WOFAdmin;!function(e){var t=function(){function t(){var t=this;this.lists=[],this.providers=[],window.canSaveData=!0,jQuery.ajaxSetup({data:{wof_nonce:jQuery(".wof-nonce").data("nonce")}}),this.formBuilderForLists=new e.Components.FormBuilderLists(jQuery("div.form-builder-for-lists")),this.wheelCtrl=new e.Controllers.CreateWheelCtrl(this.formBuilderForLists),this.wheelsListCtrl=new e.Controllers.WheelsListCtrl,this.gdprCtrl=new e.Controllers.Gdpr;var i=Core.Admin.Helpers.Context.getSettings();this.initEvents(),this.onSettingsChanged(i),this.initSetEditMode(),this.fetchLog(i),this.setLists(i),window.tinymce&&window.tinymce.on("AddEditor",function(e){setTimeout(function(){var i=e.editor;"disclaimer"===i.id&&i.setContent(t.wheelCtrl.model.disclaimer),"explainer"===i.id&&i.setContent(t.wheelCtrl.model.explainer),t.setTinyMCE(t.wheelCtrl.model,!1)},1050)},!0),jQuery('[name="mb-wof-lite-settings[mailchimp_api]"]').on("change input",function(){window.canSaveData=!0,jQuery(".mb-wof-key-error").remove(),/^[a-f0-9]{32}-us\d+$/i.test(jQuery(this).val())||(window.canSaveData=!1,jQuery('<div class="mb-wof-key-error" style="color:red;padding-top:5px;">Invalid API key. Can not save data.</div>').insertAfter(jQuery(this)))})}return t.prototype.setLists=function(t){var i=this;t.mailchimp_api&&!this.fetchedMCLists&&e.Api.Mail.getMailChimpLists().then(function(e){i.fetchedMCLists=!0,i.providers.push({id:"mailchimp",title:"MailChimp"}),i.lists.push({listProvider:"mailchimp",lists:e}),i.drawListDropdowns()})},t.prototype.fetchLog=function(t){"true"==t.log&&e.Api.Log.getLog().then(function(e){jQuery("[name=wof-log]").val(e)})},t.prototype.initEvents=function(){var t=this;Core.Admin.Dispatcher.subscribe("wof-wheel:created",function(){t.wheelsListCtrl.getWheelsList()}),Core.Admin.Dispatcher.subscribe("settings:changed",function(e){t.onSettingsChanged(e)}),Core.Admin.Dispatcher.subscribe("settings:saved",function(e){t.setLists(e)}),jQuery('[name="mb-wof-settings[woo_coupons]"]').on("change",function(e){jQuery(e.currentTarget).is(":checked")?(jQuery(".wof-wc-title").show(),jQuery(".wof-value-title").hide()):(jQuery(".wof-wc-title").hide(),jQuery(".wof-value-title").show()),jQuery("[name=wof-slice-type]").trigger("change")}),jQuery("select[name=list]").on("change",function(e){t.wheelCtrl.model.list=jQuery(e.currentTarget).val()}),jQuery("select[name=list_provider]").on("change",function(e){t.wheelCtrl.model.list_provider=jQuery(e.currentTarget).val(),t.wheelCtrl.model.list=null,t.drawListDropdowns()}),jQuery(".btn-clear-log").on("click",function(t){t.preventDefault(),e.Api.Log.clearLog(),jQuery("[name=wof-log]").val("")})},t.prototype.onSettingsChanged=function(e){void 0===e&&(e=null),e=e||Core.Admin.Helpers.Context.getSettings(),"true"==e.log?jQuery(".wof-log-wrapper").closest("tr").show():jQuery(".wof-log-wrapper").closest("tr").hide(),e.mailchimp_api?(jQuery(".error-mail-lists").hide(),jQuery(".wof-step-1").show()):(jQuery(".error-mail-lists").show(),jQuery(".wof-step-1").hide())},t.prototype.drawListDropdowns=function(){if(!this.wheelCtrl.model.list_provider&&this.providers.length>0&&(this.wheelCtrl.model.list_provider=this.providers[0].id),!this.wheelCtrl.model.list&&this.providers.length>0){var t=e.helpers.Collections.findBy(this.lists,"listProvider",this.wheelCtrl.model.list_provider);null!=t&&t.lists.length&&(this.wheelCtrl.model.list=t.lists[0].id)}if(this.wheelCtrl.model.list_provider){var i=jQuery("select[name=list_provider]").empty();this.providers.forEach(function(e){jQuery("<option />",{val:e.id,text:e.title}).appendTo(i)}),i.val(this.wheelCtrl.model.list_provider)}if(this.wheelCtrl.model.list){var r=jQuery("select[name=list]").empty(),t=e.helpers.Collections.findBy(this.lists,"listProvider",this.wheelCtrl.model.list_provider);t.lists.forEach(function(e){jQuery("<option />",{val:e.id,text:e.title}).appendTo(r)}),r.val(this.wheelCtrl.model.list)}},t.prototype.initSetEditMode=function(){var e=this;Core.Admin.Dispatcher.subscribe("wof-wheel:edit",function(t){e.wheelCtrl.setEditMode(),e.wheelCtrl.resetStepTracker(t),Core.Admin.Dispatcher.publish("tab:activate","options-addwheel"),e.drawListDropdowns(),e.formBuilderForLists.setFields(e.wheelCtrl.model.fields),e.formBuilderForLists.drawTableRows(),jQuery(".color-picker").each(function(e,i){var r=jQuery(i),o=""+t[r.attr("name")];r.closest(".wp-picker-container").find(".wp-picker-clear").trigger("click"),r.wpColorPicker("color",o)}),e.setTinyMCE(t),Core.Admin.Main.initChoicePickers(),e.gdprCtrl.initGdprSettingOptions(e.wheelCtrl.model.fields,e.wheelCtrl.model.optin_if_checked),Core.Admin.Main.loading()})},t.prototype.setTinyMCE=function(e,t){void 0===t&&(t=!0);var i=this.getTinyMCEEditor("explainer");i&&(t&&i.setContent(e.explainer?e.explainer:""),i.off("change",this.explainerOn),this.explainerOn=function(){e.explainer=i.getContent()},i.on("change",this.explainerOn));var r=this.getTinyMCEEditor("disclaimer");r&&(t&&r.setContent(e.disclaimer?e.disclaimer:""),r.off("change",this.disclaimerOn),this.disclaimerOn=function(){e.disclaimer=r.getContent()},r.on("change",this.disclaimerOn))},t.prototype.getTinyMCEEditor=function(e){if(void 0===window.tinymce)return null;for(var t=0;t<window.tinymce.editors.length;t++){var i=window.tinymce.editors[t];if(i.id===e)return i}return null},t}();e.Main=t}(WOFAdmin||(WOFAdmin={})),jQuery(document).ready(function(){new WOFAdmin.Main,window.waitForFinalEvent=function(){}});
var WOFAdmin;!function(n){!function(n){var e=function(){function n(){}return n.getLog=function(){return jQuery.getJSON(Core.Admin.Helpers.Context.getAdminAjaxUrl(),{action:n.get_log}).then(function(n){return n})},n.clearLog=function(){return jQuery.getJSON(Core.Admin.Helpers.Context.getAdminAjaxUrl(),{action:n.clear_log})},n.get_log="mb-wof-lite-get-log",n.clear_log="mb-wof-lite-clear-log",n}();n.Log=e}(n.Api||(n.Api={}))}(WOFAdmin||(WOFAdmin={}));
var WOFAdmin;!function(i){!function(i){var t=function(){function i(){}return i.getMailchimpFields=function(t){return jQuery.getJSON(Core.Admin.Helpers.Context.getAdminAjaxUrl(),{action:i.get_mailchimp_fields,id:t}).then(function(i){return i})},i.getMailChimpLists=function(){return jQuery.getJSON(Core.Admin.Helpers.Context.getAdminAjaxUrl(),{action:i.get_mailchimp_lists_action}).then(function(i){return i})},i.get_mailchimp_lists_action="mb-wof-lite-get-mailchimp-lists",i.get_mailchimp_fields="mb-wof-lite-get-mailchimp-fields",i}();i.Mail=t}(i.Api||(i.Api={}))}(WOFAdmin||(WOFAdmin={}));
var WOFAdmin;!function(e){!function(e){var t=function(){function e(){}return e.toggleActivation=function(t,n){return jQuery.post(Core.Admin.Helpers.Context.getAdminAjaxUrl(),{action:e.toggle_active_toggle,id:t,toggle:n}).then(function(e){return e})},e.updateWheel=function(t,n){return jQuery.post(Core.Admin.Helpers.Context.getAdminAjaxUrl(),{action:e.update_wheel_action,id:t,options:JSON.stringify(this.removeEmpties(n))}).then(function(e){return e})},e.addWheel=function(t){return jQuery.post(Core.Admin.Helpers.Context.getAdminAjaxUrl(),{action:e.add_wheel_action,options:JSON.stringify(this.removeEmpties(t))}).then(function(e){return e})},e.deleteWheel=function(t){return jQuery.get(Core.Admin.Helpers.Context.getAdminAjaxUrl(),{action:e.delete_wheel_action,id:t}).then(function(e){return e})},e.getWheels=function(){return jQuery.getJSON(Core.Admin.Helpers.Context.getAdminAjaxUrl(),{action:e.get_wheels_action}).then(function(e){return e})},e.getWheel=function(t){return jQuery.getJSON(Core.Admin.Helpers.Context.getAdminAjaxUrl(),{action:e.get_wheel_action,id:t}).then(function(e){return e})},e.removeEmpties=function(e){var t={};return e.active=null,Object.keys(e).forEach(function(n){void 0!==e[n]&&null!==e[n]&&(t[n]=e[n])}),t},e.get_wheel_action="mb-wof-lite-get-wheel",e.get_wheels_action="mb-wof-lite-get-wheels",e.delete_wheel_action="mb-wof-lite-delete-wheel",e.add_wheel_action="mb-wof-lite-add-wheel",e.update_wheel_action="mb-wof-lite-update-wheel",e.toggle_active_toggle="mb-wof-lite-toggle-activation",e}();e.Wheels=t}(e.Api||(e.Api={}))}(WOFAdmin||(WOFAdmin={}));
var WOFAdmin;!function(e){!function(i){var t=function(){function i(e){this.fieldsFromListServer=[],this.fieldsFromWheel=[],this.$table=e.find("table.wof-field-builder-table"),this.fieldsFromListServer=[],this.fieldsFromWheel=[],this.initEvents()}return i.prototype.initEvents=function(){var i=this;this.$table.on("change",".field-include",function(e){var t=jQuery(e.currentTarget),r=i.rowToField(t.closest("tr"));Core.Admin.Dispatcher.publish(t.is(":checked")?"field:added":"field:removed",r)}),this.$table.on("change","input[type=text],.field-required",function(t){var r=jQuery(t.currentTarget).closest("tr"),d=e.helpers.Collections.findBy(i.fieldsFromWheel,"id",r.data("field-id"));null!=d&&(d.required=r.find(".field-required").is(":checked"),d.placeholder=r.find("input[type=text]").val())}),jQuery(".btn-wof-add-custom-field").on("click",function(t){t.preventDefault();var r=jQuery("table.wof-custom-field-table"),d=r.find('select[name="wof-form-builder-type"]').val().trim(),l=r.find('input[name="wof-form-builder-placeholder"]').val().trim(),o=r.find('input[name="wof-form-builder-required"]').is(":checked"),n=i.UIToFields(),s={disableRequired:!1,options:{},placeholder:l,required:o,id:e.helpers.Collections.nextAvailableName(d,n),type:d};i.fieldsFromWheel.push(s),Core.Admin.Dispatcher.publish("field:added",s),i.drawTableRows(),window.tb_remove()})},i.prototype.getFieldsFromList=function(e,i){this.fieldsFromListServer=[],this.drawTableRows()},i.prototype.drawTableRows=function(){var i=this,t=[];this.fieldsFromWheel.forEach(function(r){if("primary_email"!==r.id){var d=e.helpers.Collections.findBy(i.fieldsFromListServer,"id",r.id),l={placeholder:r.placeholder?r.placeholder:"",checked:!0,id:r.id,required:!!r.required&&r.required,options:r.options,type:r.type,title:d?d.title:e.helpers.Strings.capitalizeWords(r.type.replace("_"," "))};t.push(l)}}),this.fieldsFromListServer.forEach(function(i){if("primary_email"!==i.id&&null==e.helpers.Collections.findBy(t,"id",i.id)){var r={placeholder:"",required:!!i.required&&i.required,checked:!1,title:i.title,id:i.id,type:i.type,options:i.options};t.push(r)}});var r=window.doT.template(jQuery("#tpl-wof-field-builder-lists-row").html());this.$table.find("tbody").html(r({fields:t}))},i.prototype.UIToFields=function(){var e=this,i=[];return this.$table.find(".form-field-tr").each(function(t,r){var d=jQuery(r),l=d.find("input[type=text]").val();d.find(".field-include").is(":checked")&&("primary_email"===d.data("field-id")?i.push({placeholder:l,required:!0,id:"primary_email",type:"primary_email"}):i.push(e.rowToField(d)))}),i},i.prototype.rowToField=function(e){var i=(e.find(".field-include").is(":checked"),e.find(".field-required").is(":checked")),t=e.find("input[type=text]").val(),r=e.data("field-type"),d=e.data("options");return{placeholder:t,required:i,id:e.data("field-id"),type:r,options:d}},i.prototype.setFields=function(e){this.fieldsFromWheel=e},i}();i.FormBuilderLists=t}(e.Components||(e.Components={}))}(WOFAdmin||(WOFAdmin={}));
var WOFAdmin;!function(n){!function(n){var r=function(){function r(){}return r.nextAvailableName=function(r,t){var i=n.Collections.findAllBy(t,"type",r),e=0;return i.forEach(function(n,r){var t=n.id.replace(/^\D+/g,"");t&&parseInt(t)>e&&(e=parseInt(t))}),r+"_"+(e+1).toString()},r.findAllBy=function(n,r,t){var i=[];return n&&n.length?(n.forEach(function(n,e){n[r]==t&&i.push(n)}),i):i},r.findBy=function(n,r,t){if(!n||!n.length)return null;var i=null;return n.forEach(function(n,e){n[r]==t&&(i=n)}),i},r}();n.Collections=r}(n.helpers||(n.helpers={}))}(WOFAdmin||(WOFAdmin={}));
var WOFAdmin;!function(n){!function(n){var r=function(){function n(){}return n.capitalizeWords=function(n){return n.replace(/\w\S*/g,function(n){return n.charAt(0).toUpperCase()+n.substr(1).toLowerCase()})},n}();n.Strings=r}(n.helpers||(n.helpers={}))}(WOFAdmin||(WOFAdmin={}));
var WOFAdmin;!function(e){!function(e){var n=function(){function e(){}return e.toTheme=function(e){switch(e){case"blue":return"Standard Blue";case"deep-purple":return"Deep Purple"}return e},e.toSliceType=function(e){switch(e){case"0":return"No prize";case"1":return"Coupon code";case"2":return"Link"}},e}();e.Wheels=n}(e.helpers||(e.helpers={}))}(WOFAdmin||(WOFAdmin={}));
var WOFAdmin;!function(n){!function(n){var i=function(){function n(){this.required=!1,this.type="text"}return n}();n.Field=i}(n.Models||(n.Models={}))}(WOFAdmin||(WOFAdmin={}));
var WOFAdmin;!function(n){!function(n){var i=function(){function n(){}return n}();n.Slice=i}(n.Models||(n.Models={}))}(WOFAdmin||(WOFAdmin={}));
var WOFAdmin;!function(n){!function(n){var i=function(){function n(){}return n}();n.Statistics=i}(n.Models||(n.Models={}))}(WOFAdmin||(WOFAdmin={}));
var WOFAdmin;!function(e){!function(e){var i=function(){function e(){this.theme="vintage",this.slices=[],this.active="1",this.winning_chance=70,this.plays=0,this.bgpattern="hearts",this.title="Get your chance to <em>win a price</em>!",this.explainer="Enter your email address and spin the wheel. This is your chance to win amazing discounts!",this.disclaimer="Our in-house rules:<ul><li>One game per user</li><li>Cheaters will be disqualified.</li></ul>",this.email_placeholder="Your email",this.button_text="Try your luck",this.button_done="I'm done playing",this.close_text="I don't feel lucky",this.losing_title="Uh oh! Looks like you lost",this.losing_text="We're sorry, the wheel of fortune has let you down. Better luck next time!",this.winning_title="Hurray! You've hit {x}. Lucky you!",this.winning_text_coupon="Nicely done! You can use the coupon code below to claim your prize:",this.winning_text_link="Nicely done! here's the link to your free product:",this.button_again="Try again",this.games_left_text="You have {x} spins left",this.user_inclusion="0",this.appeartype="delay",this.appeardelay=5,this.appearscroll=60,this.occurance="delay",this.occurancedelay=14,this.hide_mobile=!0,this.fields=[]}return e}();e.Wheel=i}(e.Models||(e.Models={}))}(WOFAdmin||(WOFAdmin={}));
"use strict";!function(e){"function"==typeof define&&define.amd?define(e):window.DataBind=e()}(function(){function e(e){return e&&window.jQuery&&e instanceof window.jQuery}function t(t){return e(t)?t[0]:t}function n(e,t){if(e){var n=void 0!==t;if(["checkbox","radio"].indexOf(e.type)>=0)return n&&(e.checked=!!t),e.checked;if(["text","hidden","textarea","select-one","email","url","week","time","search","tel","range","number","month","datetime-local","date","color","password"].indexOf(e.type)>=0){if(n){e.value=t;var o=document.createEvent("HTMLEvents");o.initEvent("change",!0,!1),e.dispatchEvent(o)}return e.value}if(["select-multiple"].indexOf(e.type)>=0){n&&(r(t)||(t=[t]));for(var i,a=[],c=e&&e.options,f=0,u=c.length;f<u;f++)i=c[f],n&&(t.indexOf(i.value)>-1?i.selected=!0:i.selected=!1),i.selected&&a.push(i.value||i.text);return a}return n&&(e.innerText=t),e.innerText}}function r(e){return"[object Array]"===Object.prototype.toString.call(e)}function o(e){return["checkbox","radio","select-one","select-multiple","password"].indexOf(e.type)>=0?"change":["text","hidden","textarea","email","url","week","time","search","tel","range","number","month","datetime-local","date","color"].indexOf(e.type)>=0?"input":void 0}function i(e){return e.hashkey||(e.hashkey=Date.now()+Math.floor(1e5*Math.random())),e.hashkey}function a(e,t){if(e&&t){var n=i(e);if(M[n]=M[n]||[],!(M[n].indexOf(t)>-1)){M[n].push(t);var r=o(e);e.addEventListener(r,t,!1)}}}function c(e,t){var n=i(e),r=M[n].indexOf(t);if(M[n]&&-1!==r){M[n].splice(r,1);var a=o(e);e.removeEventListener(a,t,!1)}}function f(e){var t=i(e),n=M[t];if(e&&n){var r,o=n.concat(),a=o.length;for(r=0;r<a;r++)c(e,o[r])}}function u(e,t){function n(){var e,t,n=!1;return t=o.exec(i[r]),t&&t.length&&(e=i[r].split("[")[0],a=a[e][+t[1]],n=!0),n}var r,o=new RegExp(/.*\[(\d+)\]/),i=t.split("."),a=e;for(r=0;r<i.length-1;r++)n()||(a=a[i[r]]);return n(),a}function l(e,t,n){var r=t.split("."),o=u(e,t);return void 0!==n&&(o[r[r.length-1]]=n),o[r[r.length-1]]}function d(e,t,r){a(e,function(e,t,n,r,o,i,a,c){return function(e){var f=o(this),u=i(this),l=r(t,n);r(t,n,f),a(c,this,{key:u,oldValue:l,newValue:f})}}(0,t,r,l,n,v,j,_))}function s(e){f(e)}function h(e,t,r){var o=function(e,t,n,r,o,i,a){return function(t,n,c,f){var t=i(e);r(e,c),o(a,e,{key:t,oldValue:f,newValue:c})}}(e,0,0,n,j,v,S);k.watch(t,r,o)}function p(e,t){var n,r=e.watchers[t];for(n=0;n<r.length;n++)k.unwatch(e,t,r[n])}function v(e){if(e)return e.getAttribute(L)}function y(e){return e=e||{},e={dom:void 0===e.dom||e.dom,model:void 0===e.model||e.model,children:void 0===e.children||e.children}}function m(e,t){if(!e||!t)return{};var n=v(e);if(!n)return{};var r=u(t,n),o=n.split(".");return o=o[o.length-1],{key:n,deepKey:o,deepModel:r,keyExists:!!r}}function g(e,t,r){if(!e||!t)return!1;var o=m(e,t);return!!o.keyExists&&(n(e,l(t,o.key)),r.dom&&d(e,o.deepModel,o.deepKey),r.model&&h(e,o.deepModel,o.deepKey),!0)}function w(e,t,n){if(e&&t){var r=m(e,t);r.keyExists&&(n.dom&&s(e),n.model&&p(r.deepModel,r.deepKey))}}function b(e,t){var n,r,o=[e];if(t.children)for(n=e.getElementsByTagName("*"),r=0;r<n.length;r++)o.push(n[r]);return o}function j(e,t,n){var r=document.createEvent("Events");r.initEvent(e,!0,!0),r.data=n,t.dispatchEvent(r)}function x(e,t,n,r){function o(e,o){u.push(o),r.dom&&e.addEventListener(n,o,!1),r.model&&e.addEventListener(t,o,!1)}function i(e,t){var n=u.indexOf(t);-1!==n&&(u.splice(n,1),r.dom&&e.removeEventListener(_,t,!1),r.model&&e.removeEventListener(S,t,!1))}function a(e){var t,n=u.concat();for(t=0;t<n.length;t++)i(e,n[t])}function c(t){var n;for(n=0;n<e.length;n++)o(e[n],t)}function f(t){var n,r=i;for(void 0===t&&(r=a),n=0;n<e.length;n++)r(e[n],t)}var u=[];return{watch:c,unwatch:f}}function O(e,n,r){if(e&&n){var o=t(e);if(o!==e)return arguments[0]=o,O.apply(this,arguments);r=y(r);var i,a=b(e,r),c=[];for(i=0;i<a.length;i++)g(a[i],n,{dom:r.dom,model:r.model})&&c.push(a[i]);var f=new x(c,S,_,r);return e.watchable=f,f}}function E(e,n,r){if(e&&n){var o=t(e);if(o!==e)return arguments[0]=o,E.apply(this,arguments);r=y(r);var i,a=b(e,r);for(i=0;i<a.length;i++)w(a[i],n,{dom:r.dom,model:r.model});e.watchable.unwatch()}}var k=function(){var e={noMore:!1},t=[],n=function(e){var t={};return e&&"[object Function]"==t.toString.call(e)},r=function(e){return e%1==0},o=function(e){return"[object Array]"===Object.prototype.toString.call(e)},i=function(e,t){var n=[],r=[];if("string"!=typeof e&&"string"!=typeof t&&!o(e)&&!o(t)){for(var i in e)t[i]||n.push(i);for(var a in t)e[a]||r.push(a)}return{added:n,removed:r}},a=function(e){if(null==e||"object"!=typeof e)return e;var t=e.constructor();for(var n in e)t[n]=e[n];return t},c=function(e,t,n,r){try{Object.defineProperty(e,t,{get:n,set:r,enumerable:!0,configurable:!0})}catch(o){try{Object.prototype.__defineGetter__.call(e,t,n),Object.prototype.__defineSetter__.call(e,t,r)}catch(e){throw"watchJS error: browser not supported :/"}}},f=function(e,t,n){try{Object.defineProperty(e,t,{enumerable:!1,configurable:!0,writable:!1,value:n})}catch(r){e[t]=n}},u=function(){n(arguments[1])?l.apply(this,arguments):o(arguments[1])?d.apply(this,arguments):s.apply(this,arguments)},l=function(e,t,n,r){if("string"!=typeof e&&(e instanceof Object||o(e))){var i=[];if(o(e))for(var a=0;a<e.length;a++)i.push(a);else for(var c in e)i.push(c);d(e,i,t,n,r)}},d=function(e,t,n,r,i){if("string"!=typeof e&&(e instanceof Object||o(e)))for(var a in t)s(e,t[a],n,r,i)},s=function(e,t,r,i,a){"string"!=typeof e&&(e instanceof Object||o(e))&&(n(e[t])||(null!=e[t]&&(void 0===i||i>0)&&(void 0!==i&&i--,l(e[t],r,i)),y(e,t,r),a&&O(e,t,r,i)))},h=function(){n(arguments[1])?p.apply(this,arguments):o(arguments[1])?v.apply(this,arguments):j.apply(this,arguments)},p=function(e,t){if(!(e instanceof String)&&(e instanceof Object||o(e))){var n=[];if(o(e))for(var r=0;r<e.length;r++)n.push(r);else for(var i in e)n.push(i);v(e,n,t)}},v=function(e,t,n){for(var r in t)j(e,t[r],n)},y=function(t,n,r){var o=t[n];b(t,n),t.watchers||f(t,"watchers",{}),t.watchers[n]||(t.watchers[n]=[]);for(var i in t.watchers[n])if(t.watchers[n][i]===r)return;t.watchers[n].push(r),c(t,n,function(){return o},function(i){var a=o;o=i,t[n]&&l(t[n],r),b(t,n),e.noMore||JSON.stringify(a)!==JSON.stringify(i)&&(m(t,n,"set",i,a),e.noMore=!1)})},m=function(e,t,n,o,i){for(var a in e.watchers[t])r(a)&&e.watchers[t][a].call(e,t,n,o,i)},g=["pop","push","reverse","shift","sort","slice","unshift"],w=function(e,t,n,r){f(e[t],r,function(){var o=n.apply(e[t],arguments);return s(e,e[t]),"slice"!==r&&m(e,t,r,arguments),o})},b=function(e,t){if(e[t]&&!(e[t]instanceof String)&&o(e[t]))for(var n,r=g.length;r--;)n=g[r],w(e,t,e[t][n],n)},j=function(e,t,n){for(var r in e.watchers[t]){e.watchers[t][r]==n&&e.watchers[t].splice(r,1)}E(e,t,n)},x=function(){for(var e in t){var n=t[e],r=i(n.obj[n.prop],n.actual);if(r.added.length||r.removed.length){if(r.added.length)for(var o in n.obj.watchers[n.prop])d(n.obj[n.prop],r.added,n.obj.watchers[n.prop][o],n.level-1,!0);m(n.obj,n.prop,"differentattr",r,n.actual)}n.actual=a(n.obj[n.prop])}},O=function(e,n,r,o){t.push({obj:e,prop:n,actual:a(e[n]),watcher:r,level:o})},E=function(e,n,r){for(var o in t){var i=t[o];i.obj==e&&i.prop==n&&i.watcher==r&&t.splice(o,1)}};return setInterval(x,50),e.watch=u,e.unwatch=h,e.callWatchers=m,e}(),M={},S="databind-model-change",_="databind-dom-change",L="data-key";return{bind:O,unbind:E}});
!function(){"use strict";function e(n,t,r){return("string"==typeof t?t:t.toString()).replace(n.define||a,function(e,t,o,a){return 0===t.indexOf("def.")&&(t=t.substring(4)),t in r||(":"===o?(n.defineParams&&a.replace(n.defineParams,function(e,n,o){r[t]={arg:n,text:o}}),t in r||(r[t]=a)):new Function("def","def['"+t+"']="+a)(r)),""}).replace(n.use||a,function(t,o){n.useParams&&(o=o.replace(n.useParams,function(e,n,t,o){if(r[t]&&r[t].arg&&o){var a=(t+":"+o).replace(/'|\\/g,"_");return r.__exp=r.__exp||{},r.__exp[a]=r[t].text.replace(new RegExp("(^|[^\\w$])"+r[t].arg+"([^\\w$])","g"),"$1"+o+"$2"),n+"def.__exp['"+a+"']"}}));var a=new Function("def","return "+o)(r);return a?e(n,a,r):a})}function n(e){return e.replace(/\\('|\\)/g,"$1").replace(/[\r\t\n]/g," ")}var t,r={engine:"doT",version:"1.1.1",templateSettings:{evaluate:/\{\{([\s\S]+?(\}?)+)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,encode:/\{\{!([\s\S]+?)\}\}/g,use:/\{\{#([\s\S]+?)\}\}/g,useParams:/(^|[^\w$])def(?:\.|\[[\'\"])([\w$\.]+)(?:[\'\"]\])?\s*\:\s*([\w$\.]+|\"[^\"]+\"|\'[^\']+\'|\{[^\}]+\})/g,define:/\{\{##\s*([\w\.$]+)\s*(\:|=)([\s\S]+?)#\}\}/g,defineParams:/^\s*([\w$]+):([\s\S]+)/,conditional:/\{\{\?(\?)?\s*([\s\S]*?)\s*\}\}/g,iterate:/\{\{~\s*(?:\}\}|([\s\S]+?)\s*\:\s*([\w$]+)\s*(?:\:\s*([\w$]+))?\s*\}\})/g,varname:"it",strip:!0,append:!0,selfcontained:!1,doNotSkipEncoded:!1},template:void 0,compile:void 0,log:!0};r.encodeHTMLSource=function(e){var n={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},t=e?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(e){return e?e.toString().replace(t,function(e){return n[e]||e}):""}},t=function(){return this||(0,eval)("this")}(),"undefined"!=typeof module&&module.exports?module.exports=r:"function"==typeof define&&define.amd?define(function(){return r}):t.doT=r;var o={append:{start:"'+(",end:")+'",startencode:"'+encodeHTML("},split:{start:"';out+=(",end:");out+='",startencode:"';out+=encodeHTML("}},a=/$^/;r.template=function(c,i,u){i=i||r.templateSettings;var d,s,p=i.append?o.append:o.split,l=0,f=i.use||i.define?e(i,c,u||{}):c;f=("var out='"+(i.strip?f.replace(/(^|\r|\n)\t* +| +\t*(\r|\n|$)/g," ").replace(/\r|\n|\t|\/\*[\s\S]*?\*\//g,""):f).replace(/'|\\/g,"\\$&").replace(i.interpolate||a,function(e,t){return p.start+n(t)+p.end}).replace(i.encode||a,function(e,t){return d=!0,p.startencode+n(t)+p.end}).replace(i.conditional||a,function(e,t,r){return t?r?"';}else if("+n(r)+"){out+='":"';}else{out+='":r?"';if("+n(r)+"){out+='":"';}out+='"}).replace(i.iterate||a,function(e,t,r,o){return t?(l+=1,s=o||"i"+l,t=n(t),"';var arr"+l+"="+t+";if(arr"+l+"){var "+r+","+s+"=-1,l"+l+"=arr"+l+".length-1;while("+s+"<l"+l+"){"+r+"=arr"+l+"["+s+"+=1];out+='"):"';} } out+='"}).replace(i.evaluate||a,function(e,t){return"';"+n(t)+"out+='"})+"';return out;").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/(\s|;|\}|^|\{)out\+='';/g,"$1").replace(/\+''/g,""),d&&(i.selfcontained||!t||t._encodeHTML||(t._encodeHTML=r.encodeHTMLSource(i.doNotSkipEncoded)),f="var encodeHTML = typeof _encodeHTML !== 'undefined' ? _encodeHTML : ("+r.encodeHTMLSource.toString()+"("+(i.doNotSkipEncoded||"")+"));"+f);try{return new Function(i.varname,f)}catch(e){throw"undefined"!=typeof console&&console.log("Could not create a template function: "+f),e}},r.compile=function(e,n){return r.template(e,null,n)}}();
var WOFAdmin;!function(e){!function(t){var n=Core.Admin.Components.StepTracker,i=function(){function t(e){this.formBuilderForLists=e,this.steptracker=new n(jQuery(".step-tracker-wrapper#add-wheel")),this.setCreateMode(),this.resetStepTracker(),this.initModelUpdates(),this.initSetTheme(),this.initSaveWheel(),this.initSliceTableChanges(),this.initRestartStepTracker()}return t.prototype.setEditMode=function(){this.mode="edit",jQuery(".btn-save-when-editing").show()},t.prototype.setCreateMode=function(){this.mode="create",jQuery(".btn-save-when-editing").hide()},t.prototype.resetStepTracker=function(t){void 0===t&&(t=null),"edit"===this.mode?this.steptracker.jumpToLastStep():this.steptracker.reset(),jQuery("[data-final-step]").hide(),this.model=null===t?new e.Models.Wheel:t,this.model.slices.length||(this.model.slices=jQuery("#add-wheel").data("slices"));var n=window.doT.template(jQuery("#tpl-woc-slice-tr").html());jQuery(".wof-slice-wrapper tbody").html(n({slices:this.model.slices})),jQuery("[name=wof-wheel-theme]").removeAttr("checked").filter("[value="+this.model.theme+"]").prop("checked",!0),window.DataBind.bind(jQuery(".step-tracker-content"),this.model),setTimeout(function(){jQuery("[name=wof-slice-type]").trigger("change")},50)},t.prototype.initSliceTableChanges=function(){var e=this;jQuery(".wof-slice-wrapper").on("change","[name=wof-slice-type]",function(e){var t=jQuery(e.currentTarget),n=t.closest("tr");0==t.val()?n.find("span.td-content").hide():n.find("span.td-content").show();var i=Core.Admin.Helpers.Context.getSettings();1==t.val()&&"true"==i.woo_coupons?(n.find("[name=wof-slice-wc-coupon-percentage]").show(),n.find(".btn-wc-coupon-settings").show(),n.find("[name=wof-slice-value]").hide()):(n.find("[name=wof-slice-wc-coupon-percentage]").hide(),n.find(".btn-wc-coupon-settings").hide(),n.find("[name=wof-slice-value]").show()),jQuery("[name=wof-slice-chance]").first().trigger("change")}),jQuery(".wof-slice-wrapper").on("change","[name=wof-slice-chance]",function(t){var n=e.getTotalPercentageOfSlices();jQuery(".wof-total-percentage").html(n.toString()).css("color",100===n?"black":"red")})},t.prototype.getTotalPercentageOfSlices=function(){var e=0;return jQuery(".wof-slice-wrapper tbody tr").each(function(t,n){var i=jQuery(n);0!=i.find("[name=wof-slice-type]").val()&&(e+=parseInt(i.find("[name=wof-slice-chance]").val()))}),e},t.prototype.initRestartStepTracker=function(){var e=this;jQuery(".btn-start-over").on("click",function(t){t.preventDefault(),e.setCreateMode(),e.resetStepTracker()})},t.prototype.initSetTheme=function(){var e=this;jQuery("[name=wof-wheel-theme]").on("click",function(){e.model.theme=jQuery("[name=wof-wheel-theme]:checked").val(),"halloween"===e.model.theme&&(e.model.bgpattern="halloween",jQuery("select[name=bgpattern]").val("halloween")),Core.Admin.Dispatcher.publish("theme:changed"),e.steptracker.next()})},t.prototype.saveSlices=function(){var e=this;if(100!=this.getTotalPercentageOfSlices())return void jQuery(".msg-incorrect-percentage").show();jQuery(".msg-incorrect-percentage").hide(),this.model.slices=[];var t=Core.Admin.Helpers.Context.getSettings();jQuery(".wof-slice-wrapper tbody tr").each(function(n,i){var o=jQuery(i),r=o.find("[name=wof-slice-type]").val();e.model.slices.push({id:n+1,chance:parseInt(o.find("[name=wof-slice-chance]").val()),label:o.find("[name=wof-slice-label]").val(),type:r,value:"true"==t.woo_coupons&&1==r?o.find("[name=wof-slice-wc-coupon-percentage]").val():o.find("[name=wof-slice-value]").val()})})},t.prototype.initSaveWheel=function(){var t=this;jQuery(".btn-save-wheel").on("click",function(n){n.preventDefault(),Core.Admin.Main.loading(),t.model.fields=[],t.model.fields=t.formBuilderForLists.UIToFields(),t.saveSlices(),"create"===t.mode?e.Api.Wheels.addWheel(t.model).then(function(){Core.Admin.Dispatcher.publish("wof-wheel:created"),jQuery("[data-step]").hide(),jQuery("[data-final-step]").show(),Core.Admin.Main.loading()}):e.Api.Wheels.updateWheel(t.model.id,t.model).then(function(){Core.Admin.Dispatcher.publish("wof-wheel:created"),jQuery("[data-step]").hide(),jQuery("[data-final-step]").show(),Core.Admin.Main.loading()})})},t.prototype.initModelUpdates=function(){var e=this;Core.Admin.Dispatcher.subscribe("color:changed",function(t){e.model[t.id]=t.color}),void 0!=window.tinymce&&window.tinymce.on("addeditor",function(t){var n=t.editor;n.on("change",function(t){e.model[n.id]=n.getContent()})},!0)},t}();t.CreateWheelCtrl=i}(e.Controllers||(e.Controllers={}))}(WOFAdmin||(WOFAdmin={}));
var WOFAdmin;!function(e){!function(n){var i=function(){function n(){this.$gdprSettingsWrapper=jQuery("[name=gdpr_settings]"),this.$checkboxesContainer=jQuery(".wof-checkboxes-list"),this.$noCheckboxesBubble=jQuery(".wof-gdpr-options-no-checkbox"),this.$hiddenInput=this.$gdprSettingsWrapper.find("input[type=hidden]"),this.initEvents()}return n.prototype.addOptionToGdprSettingUI=function(e,n){void 0===n&&(n=!1),this.$checkboxesContainer.append(jQuery('<div style="padding-top:7px;"><input name="wof-gdpr-option[]" '+(n?'checked="checked"':"")+' data-field-id="'+e.id+'" type="checkbox" id="gdpr-option-'+e.id+'" /> <label for="gdpr-option-'+e.id+'">'+e.placeholder+"</label></div>"))},n.prototype.initGdprSettingOptions=function(n,i){var t=this;i=i?i.split(","):[],this.$checkboxesContainer.empty();var o=e.helpers.Collections.findAllBy(n,"type","consent_checkbox");o.length?this.$noCheckboxesBubble.hide():this.$noCheckboxesBubble.show(),o.forEach(function(e,n){var o=i.indexOf(e.id)>-1;"consent_checkbox"===e.type&&t.addOptionToGdprSettingUI(e,o)}),this.$hiddenInput.val(i),this.$hiddenInput[0].dispatchEvent(new Event("input"))},n.prototype.initEvents=function(){var e=this;Core.Admin.Dispatcher.subscribe("field:removed",function(n){jQuery("input[type=checkbox]#gdpr-option-"+n.id).closest("div").remove();var i=e.$hiddenInput.val().split(","),t=i.indexOf(n.id);t>-1&&i.splice(t,1),e.$hiddenInput.val(i.join(","))}),Core.Admin.Dispatcher.subscribe("field:added",function(n){e.addOptionToGdprSettingUI(n,!1)}),jQuery(".wof-checkboxes-list").on("change","input[type=checkbox]",function(n){var i=[];jQuery("input[name='wof-gdpr-option[]']:checked").each(function(e,n){i.push(jQuery(n).data("field-id"))}),e.$hiddenInput.val(i.join(",")),e.$hiddenInput[0].dispatchEvent(new Event("input"))})},n}();n.Gdpr=i}(e.Controllers||(e.Controllers={}))}(WOFAdmin||(WOFAdmin={}));
var WOFAdmin;!function(e){!function(t){var i=function(){function t(){this.getWheelsList(),this.initEditWheel(),this.initDeleteWheel(),this.initDuplicateWheel(),this.initToggleActivation()}return t.prototype.initToggleActivation=function(){jQuery(".wof-wheels-list").on("click",".wof-toggle-active",function(t){var i=jQuery(t.currentTarget);e.Api.Wheels.toggleActivation(i.data("wheel"),i.is(":checked")?1:0)})},t.prototype.getWheelsList=function(){var t=this;e.Api.Wheels.getWheels().then(function(e){if(t.wheels=e,0===t.wheels.length)jQuery(".wof-no-results").show();else{jQuery(".wof-no-results").hide();var i=window.doT.template(jQuery("#tpl-wof-wheels-list").html());jQuery(".wof-wheels-list").html(i({wheels:e}))}})},t.prototype.initDuplicateWheel=function(){var t=!1;jQuery(".wof-wheels-list").on("click",".wof-duplicate-wheel",function(i){if(i.preventDefault(),!t){t=!0;var l=jQuery(i.currentTarget);l.css("opacity",.5),e.Api.Wheels.getWheel(l.data("wheel")).then(function(i){i.id=null,e.Api.Wheels.addWheel(i).then(function(){Core.Admin.Dispatcher.publish("wof-wheel:created"),t=!1,l.css("opacity",1)})})}})},t.prototype.initEditWheel=function(){jQuery(".wof-wheels-list").on("click",".wof-edit-wheel",function(t){t.preventDefault(),Core.Admin.Main.loading();var i=jQuery(t.currentTarget);e.Api.Wheels.getWheel(i.data("wheel")).then(function(e){Core.Admin.Dispatcher.publish("wof-wheel:edit",e)})})},t.prototype.initDeleteWheel=function(){jQuery(".wof-wheels-list").on("click",".wof-delete-wheel",function(t){if(t.preventDefault(),confirm("Are you sure you want to delete this wheel?")){var i=jQuery(t.currentTarget);e.Api.Wheels.deleteWheel(i.data("wheel")).then(function(){i.closest(".image-tile").hide("fast")})}})},t}();t.WheelsListCtrl=i}(e.Controllers||(e.Controllers={}))}(WOFAdmin||(WOFAdmin={}));